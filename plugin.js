CKEDITOR.plugins.add('img_editor',{icons:'img_editor',init:function(editor){editor.img_editor_path=this.path;editor.addCommand('img_editor',new CKEDITOR.dialogCommand('img_editor_dialog'));editor.ui.addButton('img_editor',{label:'Edit Image',command:'img_editor',toolbar:'editing'});if(editor.contextMenu){editor.addMenuGroup('img_editor_group');editor.addMenuItem('img_editor_item',{label:'Edit Image',icon:this.path+'icons/img_editor.png',command:'img_editor',group:'img_editor_group'});editor.contextMenu.addListener(function(element){if(element.getAscendant('img',true)){return{img_editor_item:CKEDITOR.TRISTATE_OFF};}});}CKEDITOR.dialog.add('img_editor_dialog',this.path+'dialogs/img_editor.js');}});